#parse("./localitytemplate/utilityFunctions.vm")
${locality.label} is one of the top most locality in ${locality.suburb.city.label} located in suburb ${locality.suburb.label}. 
#if($nearByLocalities)
	#set($nearByLocalityNameList = [])
	#foreach($nearLocality in $nearByLocalities)
		#set($temp = $nearByLocalityNameList.add($nearLocality.label))
	#end
	#if(${nearByLocalityNameList})
		${locality.label} is surrounded by #singularOrPlural("area" $nearByLocalityNameList) #listOfStringToSentence($nearByLocalityNameList). 
	#end
#end
#set($popularBuildersCounter = 0)
#set($popularBuildersNameList = [])
#if($topBuilders)
	#foreach($builder in $topBuilders)
		#set($temp = $popularBuildersNameList.add($builder.name))
		#set($popularBuildersCounter = $popularBuildersCounter + 1)
	#end
#end
#if($popularBuildersCounter > 0)
	There are at least $popularBuildersCounter different builders constructing their projects in ${locality.label}. 
#end
#if($popularBuildersCounter > 0)
 	Some of the key builders #isOrAre($popularBuildersNameList) #listOfStringToSentence($popularBuildersNameList) in ${locality.label}. 
#end
#set($unitTypesStringList = [])
#set($unitNamesStringList = [])
#set($minSize = 0)
#set($maxSize = 0)
#set($counter = 0)
#set($lowestPricePropery = "")
#set($unitTypeCountMap = {})
#foreach($property in $properties)
	#if(!$unitTypesStringList.contains($property.unitType))
		#set($temp = $unitTypesStringList.add($property.unitType))
	#end
	#if(!$unitNamesStringList.contains($property.unitName))
		#set($temp = $unitNamesStringList.add($property.unitName))
	#end
	#if($property.size)
		#if($counter == 0)
			#set($minSize = $property.size)
			#set($maxSize = $property.size)
			#set($counter = 1)
			#set($lowestPricePropery = $property)
		#elseif($property.size  < $minSize)
			#set($minSize = $property.size)
		#elseif($property.size > $maxSize)
			#set($maxSize = $property.size)
		#end
	#end
	#if($lowestPricePropery && $lowestPricePropery.budget && $property.budget && $property.budget < $lowestPricePropery.budget)
		#set($lowestPricePropery = $property)
	#end
	#if($unitTypeCountMap.get($property.unitType))
		#set($count = $unitTypeCountMap.get($property.unitType))
		#set($count = $count + 1)
		#set($temp = $unitTypeCountMap.put($property.unitType, $count))
	#else
		#set($temp = $unitTypeCountMap.put($property.unitType, 1))
	#end	
#end
#if($minSize > 0 && $maxSize > 0  && $maxSize > $minSize)
	Property in ${locality.label} has built up areas ranging from $numberFormatter.format($minSize) sq ft to $numberFormatter.format($maxSize) sq ft. 
#end
Projects offer #listOfStringToSentence($unitTypesStringList) with #listOfStringToSentence($unitNamesStringList) configurations.	
#if($unitTypeCountMap)
	#set($counter = 0)
	#set($unitTypeAndCountList = [])
	#foreach($entry in $unitTypeCountMap.entrySet())
		#set($str = $entry.value + " of " + $entry.key)
		#set($temp = $unitTypeAndCountList.add($str))
	#end
	#if($unitTypeAndCountList)
		${locality.label} has #listOfStringToSentence($unitTypeAndCountList) projects. 
	#end
#end

#if($locality.avgPriceRisePercentage)
	The prices in ${locality.label} have 
	#if($locality.avgPriceRisePercentage < 0)
		DECRASED by $locality.avgPriceRisePercentage
	#elseif($locality.avgPriceRisePercentage > 0)
		INCREASED by $locality.avgPriceRisePercentage
	#else
		STAYED STABLE, 
	#end
	 in past ${locality.avgPriceRiseMonths} months. 
#end

#if($locality.amenityTypeCount)
	#set($schoolsList = [])
	#set($hospitalsList = [])
	${locality.label} has many well known schools and Hospitals. 
	#foreach( $amenity in $amenities )
		#if($amenity.localityAmenityTypes.name=="school")
			#set($temp = $schoolsList.add($amenity.name))
		#end
		#if($amenity.localityAmenityTypes.name=="hospital")
		 	#set($temp = $hospitalsList.add($amenity.name))
		#end
	#end
	#if($schoolsList)
		Popular schools in ${locality.label} #isOrAre($schoolsList) #listOfStringToSentence($schoolsList). 
	#end
	#if($hospitalsList)
		Popular hospitals in ${locality.label} #isOrAre($hospitalsList) #listOfStringToSentence($hospitalsList). 
	#end
#end

#if($unitTypesStringList)
	Find popular #listOfStringToSentence($unitTypesStringList) for sale in ${locality.label} at attractive rates.
#end

#if($locality.projectStatusCount)
	#projectByStatus($locality)
#end
#if($locality.avgRatingsByCategory)
	#set($highestRatedAmenity = "")
	#set($highestRating = 0)
	#foreach($key in $locality.avgRatingsByCategory.keySet())
		#if($locality.avgRatingsByCategory.get($key) > $highestRating)
			$highestRating = $locality.avgRatingsByCategory.get($key)
			$highestRatedAmenity = $key
		#end
	#end
	#if($locality.avgRatingsByCategory.overallRating && $locality.avgRatingsByCategory.overallRating)
		${locality.label} has an average rating of $locality.avgRatingsByCategory.overallRating
		#if($highestRating > 0)
			with highest rating of $highestRating for $highestRatedAmenity
		#end
		.
	#end
#end

#if($popularProjects)
	#set($counter = 0)
	#foreach($project in $popularProjects)
		#if($project.minPricePerUnitArea && $project.maxPricePerUnitArea)
			#if($counter == 0)
				#projectDescWithLowestRate($locality.label $project)
			#elseif($counter == 1)
				Whereas #projectDescWithHighestRate($locality.label $project)
			#end
			#set($counter = $counter + 1)
		#end
		
	#end
#end
